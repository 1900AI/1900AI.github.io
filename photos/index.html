<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>1900</title>
    <link rel="stylesheet" href="/css/main.css">
<meta name="generator" content="Hexo 7.3.0"></head>
<body>
    <header>
        <div class="header-content">
            <div class="welcome">ä½ å¥½ ğŸ‘‹ æˆ‘æ˜¯1900</div>
            <nav>
                <a href="/">ä¸»é¡µ</a>
                <a href="/categories">æ–‡ç« </a>
                <a href="/photos">å½±é›†</a>
                <a href="/friends">å‹äºº</a>
                <a href="/about">å…³äº</a>
            </nav>
        </div>
    </header>

    <main>
        <div class="page-container">
    <h1 class="page-title">äººçš„ä¸€ç”Ÿï¼Œå…¶å®ä¸è¿‡æ˜¯åœ¨æ— æ•°é£æ™¯ç‰‡æ®µçš„ç»„åˆä¸­å¥”èµ°ç©¿æ¢­è€Œè¿‡çš„å§</h1>
    
    <div class="photo-book">
        <div class="book-pages">
            <div class="page left-page">
                <div class="photo-container">
                    <!-- ç…§ç‰‡å’Œä¿¡æ¯ä¼šé€šè¿‡ JavaScript åŠ¨æ€æ’å…¥ -->
                </div>
            </div>
            <div class="page right-page">
                <div class="photo-container">
                    <!-- ç…§ç‰‡å’Œä¿¡æ¯ä¼šé€šè¿‡ JavaScript åŠ¨æ€æ’å…¥ -->
                </div>
            </div>
        </div>
        <div class="book-controls">
            <button class="prev-btn">â† ä¸Šä¸€é¡µ</button>
            <button class="next-btn">ä¸‹ä¸€é¡µ â†’</button>
        </div>
    </div>
</div>

<script>
async function loadPhotos() {
    try {
        const response = await fetch('/images/gallery/photos.json');
        const photos = await response.json();
        return photos;
    } catch (error) {
        console.error('Error loading photos:', error);
        return [];
    }
}

let currentIndex = 0;
let photos = [];

function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
}

function isPortrait(photo) {
    if (!photo || !photo.width || !photo.height) {
        return false;
    }
    return photo.height / photo.width > 1;
}

function updatePhotos() {
    const leftContainer = document.querySelector('.left-page .photo-container');
    const rightContainer = document.querySelector('.right-page .photo-container');

    // æ¸…ç©ºå®¹å™¨
    leftContainer.innerHTML = '';
    rightContainer.innerHTML = '';

    if (currentIndex < photos.length) {
        const leftPhoto = photos[currentIndex];
        const isLeftPortrait = isPortrait(leftPhoto);
        
        leftContainer.className = `photo-container ${isLeftPortrait ? 'portrait-container' : 'landscape-container'}`;
        if (isLeftPortrait) {
            leftContainer.innerHTML = `
                <div class="portrait-photo-wrapper">
                    <img src="${leftPhoto.path}" alt="ç…§ç‰‡" class="photo">
                </div>
                <div class="photo-info">
                    <div class="photo-date">${leftPhoto.date}</div>
                    <div class="photo-desc">${leftPhoto.description.split('\n').join('<br>')}</div>
                </div>
            `;
        } else {
            leftContainer.innerHTML = `
                <img src="${leftPhoto.path}" alt="ç…§ç‰‡" class="photo">
                <div class="photo-info">
                    <div class="photo-date">${leftPhoto.date}</div>
                    <div class="photo-desc">${leftPhoto.description.split('\n').join('<br>')}</div>
                </div>
            `;
        }
    }

    if (currentIndex + 1 < photos.length) {
        const rightPhoto = photos[currentIndex + 1];
        const isRightPortrait = isPortrait(rightPhoto);
        
        rightContainer.className = `photo-container ${isRightPortrait ? 'portrait-container' : 'landscape-container'}`;
        if (isRightPortrait) {
            rightContainer.innerHTML = `
                <div class="portrait-photo-wrapper">
                    <img src="${rightPhoto.path}" alt="ç…§ç‰‡" class="photo">
                </div>
                <div class="photo-info">
                    <div class="photo-date">${rightPhoto.date}</div>
                    <div class="photo-desc">${rightPhoto.description.split('\n').join('<br>')}</div>
                </div>
            `;
        } else {
            rightContainer.innerHTML = `
                <img src="${rightPhoto.path}" alt="ç…§ç‰‡" class="photo">
                <div class="photo-info">
                    <div class="photo-date">${rightPhoto.date}</div>
                    <div class="photo-desc">${rightPhoto.description.split('\n').join('<br>')}</div>
                </div>
            `;
        }
    } else if (currentIndex === photos.length - 1) {
        rightContainer.innerHTML = `
            <div class="empty-page">
                <p>æœªå®Œå¾…ç»­...</p>
            </div>
        `;
    }

    document.querySelector('.prev-btn').disabled = currentIndex < 2;
    document.querySelector('.next-btn').disabled = currentIndex + 1 >= photos.length;
}

async function init() {
    photos = await loadPhotos();
    shuffleArray(photos);
    updatePhotos();

    document.querySelector('.prev-btn').addEventListener('click', () => {
        if (currentIndex >= 2) {
            currentIndex -= 2;
            updatePhotos();
        }
    });

    document.querySelector('.next-btn').addEventListener('click', () => {
        if (currentIndex + 1 < photos.length) {
            currentIndex += 2;
            if (currentIndex >= photos.length) {
                currentIndex = photos.length - 1;
            }
            updatePhotos();
        }
    });
}

init();
</script>
    </main>

    <footer>
        <p>&copy; 2024 1900</p>
    </footer>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // ä¸ºæ¯ä¸ªä»£ç å—æ·»åŠ å¤åˆ¶æŒ‰é’®
        document.querySelectorAll('figure.highlight').forEach(block => {
            const button = document.createElement('button');
            button.className = 'copy-btn';
            button.textContent = 'å¤åˆ¶';
            block.appendChild(button);

            button.addEventListener('click', () => {
                // è·å–ä»£ç å†…å®¹ï¼Œä¿ç•™æ¢è¡Œç¬¦
                const codeLines = block.querySelectorAll('.code .line');
                const code = Array.from(codeLines)
                    .map(line => line.textContent)
                    .join('\n');
                
                // å¤åˆ¶åˆ°å‰ªè´´æ¿
                navigator.clipboard.writeText(code).then(() => {
                    button.textContent = 'å·²å¤åˆ¶!';
                    button.classList.add('copied');
                    
                    // 2ç§’åæ¢å¤åŸçŠ¶
                    setTimeout(() => {
                        button.textContent = 'å¤åˆ¶';
                        button.classList.remove('copied');
                    }, 2000);
                }).catch(err => {
                    console.error('å¤åˆ¶å¤±è´¥:', err);
                    button.textContent = 'å¤åˆ¶å¤±è´¥';
                    
                    setTimeout(() => {
                        button.textContent = 'å¤åˆ¶';
                    }, 2000);
                });
            });
        });
    });
    </script>
</body>
</html>
